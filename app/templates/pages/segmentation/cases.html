{% extends "layout.html" %}

{% block content %}
<script type="text/javascript" class="init">


    $(document).ready(function () {
        let columns = [
            {
                name: 'status',
                data: null,
                render: function (data) {
                    return createStatusLabel(data, false);
                }
            },
            {
                data: null,
                render: function (data, type, row) {
                    return '<button class="btn btn-primary segmentationUploadButton">Upload</button> ' +
                        '<button style="margin-left: 30px; margin-right: 30px;" class="btn btn-primary dataDownloadButton">Download</button>';
                }
            },

        ];
        generalTable["columns"] = generalTable["columns"].concat(columns);

        // Initialize table
        $('#datatable').DataTable(generalTable);


        $('#datatable').on('draw.dt', function () {
            // Upload new segmentations
            $('.segmentationUploadButton').click(function () {
                let table = $('#datatable').DataTable();
                let rowObject = table.row($(this).closest('tr')).data();
                showSegmentationUploadModal(rowObject);
            });

            // Download data
            $('.dataDownloadButton').click(function () {
                let table = $('#datatable').DataTable();
                let rowObject = table.row($(this).closest('tr')).data();
                showDownloadModal(rowObject);
            });
        });
    });

</script>
<table id="datatable" class="table table-striped table-hover dt-responsive nowrap">
    <thead>
    <tr>
        <th></th>
        <th> Name</th>
        <th> Patient Name</th>
        <th> Modality</th>
        <th> Contrast Type</th>
        <th> Accession Number</th>
        <th> Insert Date</th>
        <th> Last Updated</th>
        <th> Last Message</th>

        <th> Status</th>
        <th> Data</th>
    </tr>
    </thead>
</table>

{% endblock %}

{% block forms %}
{% include 'forms/segmentation_upload_form.html' %}
{% include 'forms/download_form.html' %}
{% endblock %}

